<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Файлы</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body>
<!--Header-->
<header class="flex justify-between items-center px-6 py-4 bg-gray-100">
    <div class="font-bold text-lg">Logo</div>
    <nav class="space-x-4">
        <a href="/" class="text-gray-600 hover:text-black">Home</a>
    </nav>
    <a href="/logout" class="px-4 py-1 border border-gray-300 rounded hover:bg-gray-200 inline-block text-center">
        Log out
    </a>
</header>

<!--Main-->
<main class="max-w-4xl mx-auto py-8 px-4">
    <div id="page-name" class="text-center mb-6">
        <a class="text-3xl font-bold text-center border-b-2">
            Список доступного теортетического материала
        </a>
    </div>
    <div id="materials-list" class="max-w-4xl mx-auto py-8 px-4">
        <ul role="list" class="divide-y divide-gray-100 rounded-md border border-gray-200">
            <li th:each="file : ${files}" class="flex items-center justify-between py-4 pr-5 pl-4 text-sm/6">
                <div class="flex w-0 flex-1 items-center">
                    <svg class="size-5 shrink-0 text-gray-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon">
                        <path fill-rule="evenodd" d="M15.621 4.379a3 3 0 0 0-4.242 0l-7 7a3 3 0 0 0 4.241 4.243h.001l.497-.5a.75.75 0 0 1 1.064 1.057l-.498.501-.002.002a4.5 4.5 0 0 1-6.364-6.364l7-7a4.5 4.5 0 0 1 6.368 6.36l-3.455 3.553A2.625 2.625 0 1 1 9.52 9.52l3.45-3.451a.75.75 0 1 1 1.061 1.06l-3.45 3.451a1.125 1.125 0 0 0 1.587 1.595l3.454-3.553a3 3 0 0 0 0-4.242Z" clip-rule="evenodd"></path>
                    </svg>
                    <div class="ml-4 flex min-w-0 flex-1 gap-2">
                        <span th:text="${file} "class="truncate font-medium"/>
                    </div>
                </div>
                <div class="ml-4 shrink-0">
                    <a href="#" class="font-medium text-indigo-600 hover:text-indigo-500">Download</a>
                </div>
            </li>
        </ul>
    </div>
    <div id="load-material-button" class="my-8 text-center">
        <button type="button" onclick="addMaterialLoadField()" class="bg-gray-200 px-6 py-2 rounded hover:bg-gray-300">
            Добавить материал
        </button>
    </div>
    <div id="load-additional-material" class="space-y-8"></div>
</main>

<!--Footer-->
<footer class="flex justify-between items-center px-6 py-4 bg-gray-100 mt-12">
    <div class="font-bold">Logo</div>
    <nav class="space-x-4">
        <a href="/" class="text-gray-600 hover:text-black">Home</a>
    </nav>
    <select class="border border-gray-300 rounded px-2 py-1">
        <option>Dropdown</option>
    </select>
</footer>

<script>
    function addMaterialLoadField() {
        const mDiv = document.createElement("div");
        mDiv.className = "border p-4 rounded";
        mDiv.id = "load-file-section";
        mDiv.innerHTML = `
        <div class="flex items-center justify-center">
            <form method="post" enctype="multipart/form-data" action="/materials/upload" class="flex flex-col items-center upload-form">
                <input type="file" name="file" accept=".pdf" class="hidden file-input" required>
                <div class="mt-2 flex justify-center rounded-lg border border-dashed border-gray-900/25 px-6 py-10 text-center transition drop-area cursor-pointer">
                    <p><span class="text-blue-600 font-semibold">Upload a file</span> or drag and drop</p>
                </div>
                <button class="mt-4 bg-gray-200 px-6 py-2 rounded hover:bg-gray-300" type="submit">
                    Загрузить
                </button>
            </form>
        </div>
    `;
        document.getElementById("load-additional-material").appendChild(mDiv);

        const newDropArea = mDiv.querySelector('.drop-area');
        const fileInput = mDiv.querySelector('.file-input');
        const form = mDiv.querySelector('form');

        ['dragenter', 'dragover'].forEach(eventName => {
            newDropArea.addEventListener(eventName, (e) => {
                e.preventDefault();
                e.stopPropagation();
                newDropArea.classList.add('border-blue-500', 'bg-blue-50');
            });
        });

        ['dragleave', 'drop'].forEach(eventName => {
            newDropArea.addEventListener(eventName, (e) => {
                e.preventDefault();
                e.stopPropagation();
                newDropArea.classList.remove('border-blue-500', 'bg-blue-50');
            });
        });

        newDropArea.addEventListener('drop', (e) => {
            e.preventDefault();
            e.stopPropagation();

            const files = e.dataTransfer.files;
            if (files.length > 0) {
                fileInput.files = files;
                form.submit();
            }
        });

        newDropArea.addEventListener('click', () => {
            fileInput.click();
        });
    }
</script>
</body>
</html>
